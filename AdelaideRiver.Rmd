---
title: "Untitled"
output: html_document
---
```{r}
library(ggplot2)
library(dplyr)
library(ncdf4)
library(lubridate)
```

```{r}
files <- Sys.glob("outputs/*")
fname <-files[1]
f <- nc_open(fname)
#head(f)

cica <-ncvar_get(f, "cica")

t <- ncvar_get(f, "time")
time_from <- substr(ncatt_get(f, "time")$units, 15, 33)
datetime <- as.POSIXct(t, origin=time_from, format = "%Y-%m-%d %H:%M")


df <- data.frame(datetime, cica)
colnames(df)<- c("datetime", "cica")
df$year <- year(df$date)
df$month <- month(df$date)
df$doy <- yday(df$date)
df$hour <- hour(df$date)
df <- df[df$cica > -500, ]
```



```{r}
plot(df$datetime, df$cica)
```

```{r}
df_grp_hod <- group_by(df, hour) 
df_hour <- summarize(df_grp_hod, mean(cica)) 
plot(df_hour)
```

```{r}
df_grp_doy <- group_by(df, doy) 
df_doy <- summarize(df_grp_doy, mean(cica)) 
plot(df_doy)
```

```{r}
df_grp_month <- group_by(df, month) 
df_month <- summarize(df_grp_month, mean(cica)) 
plot(df_month)
```



```{r}
# Obviously this one would look better if you had more years!!!
df_grp_year <- group_by(df, year) 
df_year <- summarize(df_grp_year, mean(cica)) 
plot(df_year)
```
```{r}
#df_summer <- df[((df$month == 12) & (df$month == 1) & (df$month == 2)), ]
#plot(df_summer)
```

